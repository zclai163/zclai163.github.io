<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />





  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "daovoice_app_id"
    });
  daovoice('update');
  </script>














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="SQL语句练习," />





  <link rel="alternate" href="/atom.xml" title="Insomnia" type="application/atom+xml" />






<meta name="description" content="1. 用一条SQL 语句 查询出每门课都大于80 分的学生姓名 name   course grade 张三    语文       81 张三     数学       75 李四     语文       76 李四     数学       90 王五     语文       81 王五     数学       100 王五     英语       90 1select name fr">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL语句练习">
<meta property="og:url" content="http://yoursite.com/2020/04/16/SQL%E8%AF%AD%E5%8F%A5%E7%BB%83%E4%B9%A0/index.html">
<meta property="og:site_name" content="Insomnia">
<meta property="og:description" content="1. 用一条SQL 语句 查询出每门课都大于80 分的学生姓名 name   course grade 张三    语文       81 张三     数学       75 李四     语文       76 李四     数学       90 王五     语文       81 王五     数学       100 王五     英语       90 1select name fr">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/10870953-a9ce8600ab818b63.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">
<meta property="article:published_time" content="2020-04-16T11:38:55.000Z">
<meta property="article:modified_time" content="2020-04-16T11:39:48.704Z">
<meta property="article:author" content="Insomnia">
<meta property="article:tag" content="SQL语句练习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/10870953-a9ce8600ab818b63.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/04/16/SQL语句练习/"/>





<!-- 网页加载条 -->
<script src="https://neveryu.github.io/js/src/pace.min.js"></script>

  <title>SQL语句练习 | Insomnia</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://http://insomnia.ltd/" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Insomnia</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/16/SQL%E8%AF%AD%E5%8F%A5%E7%BB%83%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Insomnia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/Insomnia.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Insomnia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">SQL语句练习</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-04-16T19:38:55+08:00">
                2020-04-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SQL/" itemprop="url" rel="index">
                    <span itemprop="name">SQL</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/04/16/SQL%E8%AF%AD%E5%8F%A5%E7%BB%83%E4%B9%A0/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2020/04/16/SQL%E8%AF%AD%E5%8F%A5%E7%BB%83%E4%B9%A0/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2020/04/16/SQL%E8%AF%AD%E5%8F%A5%E7%BB%83%E4%B9%A0/" class="leancloud_visitors" data-flag-title="SQL语句练习">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
                 <span>℃</span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5.2k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  26
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>1. 用一条SQL 语句 查询出每门课都大于80 分的学生姓名</strong></p>
<p>name   course grade<br> 张三    语文       81<br> 张三     数学       75<br> 李四     语文       76<br> 李四     数学       90<br> 王五     语文       81<br> 王五     数学       100<br> 王五     英语       90</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">select</span> name <span class="keyword">from</span> table <span class="keyword">group</span> <span class="keyword">by</span> name having <span class="title">min</span>(<span class="params">grade</span>) &gt; 80</span></span><br></pre></td></tr></table></figure>

<p><strong>2. 现有学生表如下:</strong><br> 自动编号   学号   姓名 课程编号 课程名称 分数<br> 1        2005001 张三 0001     数学    69<br> 2        2005002 李四 0001      数学    89<br> 3        2005001 张三 0001      数学    69<br> <strong>删除除了自动编号不同, 其他都相同的学生冗余信息</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">delete tablename <span class="keyword">where</span> 自动编号 <span class="function">not <span class="title">in</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">select</span> min( 自动编号</span>) </span></span><br><span class="line"><span class="function">    <span class="keyword">from</span> tablename </span></span><br><span class="line"><span class="function">    <span class="keyword">group</span> <span class="keyword">by</span> 学号, 姓名, 课程编号, 课程名称, 分数</span></span><br><span class="line"><span class="function">)</span></span><br></pre></td></tr></table></figure>

<p><strong>3. 一个叫 team 的表，里面只有一个字段name, 一共有4 条纪录，分别是a,b,c,d, 对应四个球对，现在四个球对进行比赛，用一条sql 语句显示所有可能的比赛组合</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">select</span> <span class="selector-tag">a</span><span class="selector-class">.name</span>, <span class="selector-tag">b</span><span class="selector-class">.name</span></span><br><span class="line"><span class="selector-tag">from</span> <span class="selector-tag">team</span> <span class="selector-tag">a</span>, <span class="selector-tag">team</span> <span class="selector-tag">b</span> </span><br><span class="line"><span class="selector-tag">where</span> <span class="selector-tag">a</span><span class="selector-class">.name</span> &lt; <span class="selector-tag">b</span><span class="selector-class">.name</span></span><br></pre></td></tr></table></figure>

<p><strong>4. 请用SQL 语句实现：从TestDB 数据表中查询出所有月份的发生额都比101 科目相应月份的发生额高的科目。</strong><br> 请注意：TestDB 中有很多科目，都有1~12月份的发生额。<br> AccID ：科目代码，Occmonth ：发生额月份，DebitOccur ：发生额。<br> 数据库名：JcyAudit ，数据集：Select * from TestDB</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.*</span><br><span class="line"><span class="keyword">from</span> TestDB a, </span><br><span class="line">    (<span class="keyword">select</span> Occmonth, max(DebitOccur) <span class="keyword">as</span> Debit101ccur </span><br><span class="line">    <span class="keyword">from</span> TestDB </span><br><span class="line">    <span class="keyword">where</span> AccID=<span class="string">'101'</span> </span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> Occmonth) b</span><br><span class="line"><span class="keyword">where</span> a.Occmonth = b.Occmonth and a.DebitOccur &gt; b.Debit101ccur</span><br></pre></td></tr></table></figure>

<p><strong>5. 怎么把这样一个数据表</strong><br> year   month amount<br> 1991   1     1.1<br> 1991   2     1.2<br> 1991   3     1.3<br> 1991   4     1.4<br> 1992   1     2.1<br> 1992   2     2.2<br> 1992   3     2.3<br> 1992   4     2.4<br> <strong>查成这样一个结果？</strong><br> year m1   m2   m3   m4<br> 1991 1.1 1.2 1.3 1.4<br> 1992 2.1 2.2 2.3 2.4</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> year, </span><br><span class="line">    (<span class="keyword">select</span> amount <span class="keyword">from</span> table m <span class="keyword">where</span> month=<span class="number">1</span> and m.year=table.year) <span class="keyword">as</span> m1,</span><br><span class="line">    (<span class="keyword">select</span> amount <span class="keyword">from</span> table m <span class="keyword">where</span> month=<span class="number">2</span> and m.year=table.year) <span class="keyword">as</span> m2,</span><br><span class="line">    (<span class="keyword">select</span> amount <span class="keyword">from</span> table m <span class="keyword">where</span> month=<span class="number">3</span> and m.year=table.year) <span class="keyword">as</span> m3,</span><br><span class="line">    (<span class="keyword">select</span> amount <span class="keyword">from</span> table m <span class="keyword">where</span> month=<span class="number">4</span> and m.year=table.year) <span class="keyword">as</span> m4</span><br><span class="line"><span class="keyword">from</span> table <span class="keyword">group</span> <span class="keyword">by</span> year</span><br></pre></td></tr></table></figure>

<p><strong>6. 有表A，结构如下：</strong><br> p_ID p_Num s_id<br> 1 10 01<br> 1 12 02<br> 2 8 01<br> 3 11 01<br> 3 8 03<br> 其中：p_ID为产品ID，p_Num为产品库存量，s_id为仓库ID。<br> <strong>请用SQL语句实现将上表中的数据合并，合并后的数据为：</strong><br> p_ID s1_id s2_id s3_id<br> 1 10 12 0<br> 2 8 0 0<br> 3 11 0 8<br> 其中：s1_id为仓库1的库存量，s2_id为仓库2的库存量，s3_id为仓库3的库存量。如果该产品在某仓库中无库存量，那么就是0代替。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> p_id,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> s_id=<span class="number">1</span> then p_num <span class="keyword">else</span> <span class="number">0</span> end) <span class="keyword">as</span> s1_id,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> s_id=<span class="number">2</span> then p_num <span class="keyword">else</span> <span class="number">0</span> end) <span class="keyword">as</span> s2_id,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> s_id=<span class="number">3</span> then p_num <span class="keyword">else</span> <span class="number">0</span> end) <span class="keyword">as</span> s3_id</span><br><span class="line"><span class="keyword">from</span> myPro <span class="keyword">group</span> <span class="keyword">by</span> p_id</span><br></pre></td></tr></table></figure>

<hr>
<p>下面进入正题。首先创建数据表：</p>
<p><strong>学生表 Student</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">create table <span class="title">Student</span>(<span class="params">Sid varchar(<span class="number">6</span></span>), Sname <span class="title">varchar</span>(<span class="params"><span class="number">10</span></span>), Sage datetime, Ssex <span class="title">varchar</span>(<span class="params"><span class="number">10</span></span>))</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'01'</span> , <span class="string">'赵雷'</span> , <span class="string">'1990-01-01'</span> , <span class="string">'男'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'02'</span> , <span class="string">'钱电'</span> , <span class="string">'1990-12-21'</span> , <span class="string">'男'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'03'</span> , <span class="string">'孙风'</span> , <span class="string">'1990-05-20'</span> , <span class="string">'男'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'04'</span> , <span class="string">'李云'</span> , <span class="string">'1990-08-06'</span> , <span class="string">'男'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'05'</span> , <span class="string">'周梅'</span> , <span class="string">'1991-12-01'</span> , <span class="string">'女'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'06'</span> , <span class="string">'吴兰'</span> , <span class="string">'1992-03-01'</span> , <span class="string">'女'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'07'</span> , <span class="string">'郑竹'</span> , <span class="string">'1989-07-01'</span> , <span class="string">'女'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Student <span class="title">values</span>(<span class="params"><span class="string">'08'</span> , <span class="string">'王菊'</span> , <span class="string">'1990-01-20'</span> , <span class="string">'女'</span></span>)</span></span><br></pre></td></tr></table></figure>

<p><strong>成绩表 SC</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">create table <span class="title">SC</span>(<span class="params">Sid varchar(<span class="number">10</span></span>), Cid <span class="title">varchar</span>(<span class="params"><span class="number">10</span></span>), score <span class="title">decimal</span>(<span class="params"><span class="number">18</span>,<span class="number">1</span></span>))</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'01'</span> , <span class="string">'01'</span> , <span class="number">80</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'01'</span> , <span class="string">'02'</span> , <span class="number">90</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'01'</span> , <span class="string">'03'</span> , <span class="number">99</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'02'</span> , <span class="string">'01'</span> , <span class="number">70</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'02'</span> , <span class="string">'02'</span> , <span class="number">60</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'02'</span> , <span class="string">'03'</span> , <span class="number">80</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'03'</span> , <span class="string">'01'</span> , <span class="number">80</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'03'</span> , <span class="string">'02'</span> , <span class="number">80</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'03'</span> , <span class="string">'03'</span> , <span class="number">80</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'04'</span> , <span class="string">'01'</span> , <span class="number">50</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'04'</span> , <span class="string">'02'</span> , <span class="number">30</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'04'</span> , <span class="string">'03'</span> , <span class="number">20</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'05'</span> , <span class="string">'01'</span> , <span class="number">76</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'05'</span> , <span class="string">'02'</span> , <span class="number">87</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'06'</span> , <span class="string">'01'</span> , <span class="number">31</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'06'</span> , <span class="string">'03'</span> , <span class="number">34</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'07'</span> , <span class="string">'02'</span> , <span class="number">89</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> SC <span class="title">values</span>(<span class="params"><span class="string">'07'</span> , <span class="string">'03'</span> , <span class="number">98</span></span>)</span></span><br></pre></td></tr></table></figure>

<p><strong>课程表 Course</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">create table <span class="title">Course</span>(<span class="params">Cid varchar(<span class="number">10</span></span>),Cname <span class="title">varchar</span>(<span class="params"><span class="number">10</span></span>),Tid <span class="title">varchar</span>(<span class="params"><span class="number">10</span></span>))</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Course <span class="title">values</span>(<span class="params"><span class="string">'01'</span> , <span class="string">'语文'</span> , <span class="string">'02'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Course <span class="title">values</span>(<span class="params"><span class="string">'02'</span> , <span class="string">'数学'</span> , <span class="string">'01'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Course <span class="title">values</span>(<span class="params"><span class="string">'03'</span> , <span class="string">'英语'</span> , <span class="string">'03'</span></span>)</span></span><br></pre></td></tr></table></figure>

<p><strong>教师表 Teacher</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">create table <span class="title">Teacher</span>(<span class="params">Tid varchar(<span class="number">10</span></span>),Tname <span class="title">varchar</span>(<span class="params"><span class="number">10</span></span>))</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Teacher <span class="title">values</span>(<span class="params"><span class="string">'01'</span> , <span class="string">'张三'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Teacher <span class="title">values</span>(<span class="params"><span class="string">'02'</span> , <span class="string">'李四'</span></span>)</span>;</span><br><span class="line"><span class="function">insert <span class="keyword">into</span> Teacher <span class="title">values</span>(<span class="params"><span class="string">'03'</span> , <span class="string">'王五'</span></span>)</span></span><br></pre></td></tr></table></figure>

<p>四张表之间的关联很简单：</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/10870953-a9ce8600ab818b63.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>
<p>表格关联</p>
<p>（以下题目的顺序和原文相对应）</p>
<p><strong>1. 查询” 01 “课程比” 02 “课程成绩高的学生的信息及课程分数</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.*, a.score <span class="keyword">as</span> score_01, b.score <span class="keyword">as</span> score_02</span><br><span class="line"><span class="keyword">from</span> student s,</span><br><span class="line">     (<span class="keyword">select</span> sid, score <span class="keyword">from</span> sc <span class="keyword">where</span> cid=<span class="number">01</span>) a,</span><br><span class="line">     (<span class="keyword">select</span> sid, score <span class="keyword">from</span> sc <span class="keyword">where</span> cid=<span class="number">02</span>) b</span><br><span class="line"><span class="keyword">where</span> a.sid = b.sid and a.score &gt; b.score and s.sid = a.sid</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+----------+----------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">| score_01 |</span> score_02 <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+----------+----------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">02</span>   <span class="params">| 钱电   |</span> <span class="number">1990</span>-<span class="number">12</span>-<span class="number">21</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span>     <span class="number">70.0</span> <span class="params">|     60.0 |</span></span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">| 1990-08-06 00:00:00 |</span> 男   <span class="params">|     50.0 |</span>     <span class="number">30.0</span> <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+----------+----------+</span></span><br><span class="line"><span class="params">2 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p><strong>2. 查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid, sname, avg(score) <span class="keyword">as</span> avg_score</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> s, sc</span><br><span class="line"><span class="keyword">where</span> s.sid = sc.sid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> s.sid</span><br><span class="line">having avg_score &gt; <span class="number">60</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+-----------+</span><br><span class="line"><span class="params">| sid  |</span> sname  <span class="params">| avg_score |</span></span><br><span class="line">+------+--------+-----------+</span><br><span class="line"><span class="params">| 01   |</span> 赵雷   <span class="params">|  89.66667 |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">|  70.00000 |</span></span><br><span class="line"><span class="params">| 03   |</span> 孙风   <span class="params">|  80.00000 |</span></span><br><span class="line"><span class="params">| 05   |</span> 周梅   <span class="params">|  81.50000 |</span></span><br><span class="line"><span class="params">| 07   |</span> 郑竹   <span class="params">|  93.50000 |</span></span><br><span class="line">+------+--------+-----------+</span><br><span class="line"><span class="number">5</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>3. 查询在 SC 表存在成绩的学生信息</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="keyword">where</span> sid <span class="title">in</span> (<span class="params"><span class="keyword">select</span> sid <span class="keyword">from</span> sc <span class="keyword">where</span> score <span class="keyword">is</span> not <span class="literal">null</span></span>)</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 赵雷   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">| 1990-12-21 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span> <span class="number">1990</span>-<span class="number">05</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">| 1990-08-06 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">05</span>   <span class="params">| 周梅   |</span> <span class="number">1991</span>-<span class="number">12</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">| 1992-03-01 00:00:00 |</span> 女   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">07</span>   <span class="params">| 郑竹   |</span> <span class="number">1989</span>-<span class="number">07</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">7</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>4. 查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩(没成绩的显示为 null )</strong></p>
<p>这道题得用到left join或者right join，不能用where连接，因为题目说了要求有显示为null的，where是inner join，不会出现null，在这道题里会查不出第08号学生。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid, s.sname, count(cid) <span class="keyword">as</span> 选课总数, sum(score) <span class="keyword">as</span> 总成绩</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> s left <span class="keyword">join</span> sc</span><br><span class="line"><span class="keyword">on</span> s.sid = sc.sid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> s.sid</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+--------------+-----------+</span><br><span class="line"><span class="params">| sid  |</span> sname  <span class="params">| 选课总数     |</span> 总成绩    <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+--------------+-----------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 赵雷   |</span>            <span class="number">3</span> <span class="params">|     269.0 |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">|            3 |</span>     <span class="number">210.0</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span>            <span class="number">3</span> <span class="params">|     240.0 |</span></span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">|            3 |</span>     <span class="number">100.0</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">05</span>   <span class="params">| 周梅   |</span>            <span class="number">2</span> <span class="params">|     163.0 |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">|            2 |</span>      <span class="number">65.0</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">07</span>   <span class="params">| 郑竹   |</span>            <span class="number">2</span> <span class="params">|     187.0 |</span></span><br><span class="line"><span class="params">| 08   |</span> 王菊   <span class="params">|            0 |</span>      NULL <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+--------------+-----------+</span></span><br><span class="line"><span class="params">8 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p><strong>4.1 查有成绩的学生信息</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid, s.sname, count(*) <span class="keyword">as</span> 选课总数, sum(score) <span class="keyword">as</span> 总成绩,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> cid = <span class="number">01</span> then score <span class="keyword">else</span> <span class="literal">null</span> end) <span class="keyword">as</span> score_01,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> cid = <span class="number">02</span> then score <span class="keyword">else</span> <span class="literal">null</span> end) <span class="keyword">as</span> score_02,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> cid = <span class="number">03</span> then score <span class="keyword">else</span> <span class="literal">null</span> end) <span class="keyword">as</span> score_03</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> s, sc</span><br><span class="line"><span class="keyword">where</span> s.sid = sc.sid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> s.sid</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+--------------+-----------+----------+----------+----------+</span><br><span class="line"><span class="params">| sid  |</span> sname  <span class="params">| 选课总数     |</span> 总成绩    <span class="params">| score_01 |</span> score_02 <span class="params">| score_03 |</span></span><br><span class="line">+------+--------+--------------+-----------+----------+----------+----------+</span><br><span class="line"><span class="params">| 01   |</span> 赵雷   <span class="params">|            3 |</span>     <span class="number">269.0</span> <span class="params">|     80.0 |</span>     <span class="number">90.0</span> <span class="params">|     99.0 |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">|            3 |</span>     <span class="number">210.0</span> <span class="params">|     70.0 |</span>     <span class="number">60.0</span> <span class="params">|     80.0 |</span></span><br><span class="line"><span class="params">| 03   |</span> 孙风   <span class="params">|            3 |</span>     <span class="number">240.0</span> <span class="params">|     80.0 |</span>     <span class="number">80.0</span> <span class="params">|     80.0 |</span></span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">|            3 |</span>     <span class="number">100.0</span> <span class="params">|     50.0 |</span>     <span class="number">30.0</span> <span class="params">|     20.0 |</span></span><br><span class="line"><span class="params">| 05   |</span> 周梅   <span class="params">|            2 |</span>     <span class="number">163.0</span> <span class="params">|     76.0 |</span>     <span class="number">87.0</span> <span class="params">|     NULL |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">|            2 |</span>      <span class="number">65.0</span> <span class="params">|     31.0 |</span>     NULL <span class="params">|     34.0 |</span></span><br><span class="line"><span class="params">| 07   |</span> 郑竹   <span class="params">|            2 |</span>     <span class="number">187.0</span> <span class="params">|     NULL |</span>     <span class="number">89.0</span> <span class="params">|     98.0 |</span></span><br><span class="line">+------+--------+--------------+-----------+----------+----------+----------+</span><br><span class="line"><span class="number">7</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>5. 查询「李」姓老师的数量</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">select</span> <span class="title">count</span>(<span class="params">tname</span>) <span class="keyword">from</span> teacher <span class="keyword">where</span> tname like '李%'</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+--------------+</span><br><span class="line"><span class="params">| count(tname) |</span></span><br><span class="line">+--------------+</span><br><span class="line"><span class="params">|            1 |</span></span><br><span class="line">+--------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>6. 查询学过「张三」老师授课的同学的信息</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="keyword">where</span> sid <span class="title">in</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">select</span> sid <span class="keyword">from</span> sc, course, teacher</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">where</span> sc.cid = course.cid</span></span></span><br><span class="line"><span class="function"><span class="params">     and course.tid = teacher.tid</span></span></span><br><span class="line"><span class="function"><span class="params">     and tname = <span class="string">'张三'</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>)</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 赵雷   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">| 1990-12-21 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span> <span class="number">1990</span>-<span class="number">05</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">| 1990-08-06 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">05</span>   <span class="params">| 周梅   |</span> <span class="number">1991</span>-<span class="number">12</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line"><span class="params">| 07   |</span> 郑竹   <span class="params">| 1989-07-01 00:00:00 |</span> 女   <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">6 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p>原作者的写法里面用到了等号 =，虽然得到同样的结果，但是这样写不太好，因为不确定张三老师是不是只教授一门课（只不过现在的数据量太小了而已），in 适用于一个或多个返回结果的情况，适应性比等号更广。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> Student</span><br><span class="line"><span class="function"><span class="keyword">where</span> sid <span class="title">in</span>(<span class="params"><span class="keyword">select</span> distinct Sid <span class="keyword">from</span> SC</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">where</span> cid=(<span class="keyword">select</span> Cid <span class="keyword">from</span> Course</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">where</span> Tid=(<span class="keyword">select</span> Tid <span class="keyword">from</span> Teacher <span class="keyword">where</span> Tname=<span class="string">'张三'</span></span>)))</span></span><br></pre></td></tr></table></figure>

<p><strong>7. 查询没有学全所有课程的同学的信息</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="keyword">where</span> sid <span class="title">in</span> (<span class="params"><span class="keyword">select</span> sid <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> sid having count(cid</span>) &lt; 3)</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">05</span>   <span class="params">| 周梅   |</span> <span class="number">1991</span>-<span class="number">12</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">| 1992-03-01 00:00:00 |</span> 女   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">07</span>   <span class="params">| 郑竹   |</span> <span class="number">1989</span>-<span class="number">07</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>9. 查询和” 01 “号的同学学习的课程完全相同的其他同学的信息</strong><br> 这道题号称是所有题目里最难的一道，我虽然做了出来，但是写法很麻烦，不必要。原作者写的很简洁：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> Student</span><br><span class="line"><span class="function"><span class="keyword">where</span> Sid <span class="title">in</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">select</span> Sid <span class="keyword">from</span> SC</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">where</span> Cid <span class="keyword">in</span> (<span class="keyword">select</span> Cid <span class="keyword">from</span> SC <span class="keyword">where</span> Sid = <span class="string">'01'</span></span>) and Sid &lt;&gt;'01'</span></span><br><span class="line"><span class="function">    <span class="keyword">group</span> <span class="keyword">by</span> Sid</span></span><br><span class="line"><span class="function">    having <span class="title">COUNT</span>(<span class="params">Cid</span>)&gt;</span>=<span class="number">3</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">02</span>   <span class="params">| 钱电   |</span> <span class="number">1990</span>-<span class="number">12</span>-<span class="number">21</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 03   |</span> 孙风   <span class="params">| 1990-05-20 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">04</span>   <span class="params">| 李云   |</span> <span class="number">1990</span>-08-<span class="number">06</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p>我写的就太麻烦啦。。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="keyword">where</span> sid <span class="title">in</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">select</span> B.sid</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">from</span></span></span></span><br><span class="line"><span class="function"><span class="params">        (<span class="keyword">select</span> sid,</span></span></span><br><span class="line"><span class="function"><span class="params">            sum(<span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">01</span> then <span class="number">1</span> else <span class="number">0</span> end</span>) <span class="keyword">as</span> course_01,</span></span><br><span class="line"><span class="function">            <span class="title">sum</span>(<span class="params"><span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">02</span> then <span class="number">1</span> else <span class="number">0</span> end</span>) <span class="keyword">as</span> course_02,</span></span><br><span class="line"><span class="function">            <span class="title">sum</span>(<span class="params"><span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">03</span> then <span class="number">1</span> else <span class="number">0</span> end</span>) <span class="keyword">as</span> course_03</span></span><br><span class="line"><span class="function">        <span class="keyword">from</span> sc <span class="keyword">where</span> sid</span> = <span class="number">01</span> <span class="keyword">group</span> <span class="keyword">by</span> sid) <span class="keyword">as</span> A,</span><br><span class="line">        (<span class="keyword">select</span> sid,</span><br><span class="line">            sum(<span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">01</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end) <span class="keyword">as</span> course_01,</span><br><span class="line">            sum(<span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">02</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end) <span class="keyword">as</span> course_02,</span><br><span class="line">            sum(<span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">03</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end) <span class="keyword">as</span> course_03</span><br><span class="line">        <span class="keyword">from</span> sc <span class="keyword">where</span> sid != <span class="number">01</span> <span class="keyword">group</span> <span class="keyword">by</span> sid) <span class="keyword">as</span> B</span><br><span class="line">    <span class="keyword">where</span> A.course_01=B.course_01 and A.course_02=B.course_02 and A.course_03=B.course_03</span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">02</span>   <span class="params">| 钱电   |</span> <span class="number">1990</span>-<span class="number">12</span>-<span class="number">21</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 03   |</span> 孙风   <span class="params">| 1990-05-20 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">04</span>   <span class="params">| 李云   |</span> <span class="number">1990</span>-08-<span class="number">06</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>8. 查询至少有一门课与学号为” 01 “的同学所学相同的同学的信息</strong></p>
<p>和第9题基本一致，还是原作者写的好一些</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> Student <span class="keyword">where</span> Sid <span class="title">in</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">select</span> distinct Sid <span class="keyword">from</span> SC <span class="keyword">where</span> Cid <span class="keyword">in</span>(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">select</span> Cid <span class="keyword">from</span> SC <span class="keyword">where</span> Sid=<span class="string">'01'</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span>)</span></span><br><span class="line"><span class="function">)</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 赵雷   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">| 1990-12-21 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span> <span class="number">1990</span>-<span class="number">05</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">| 1990-08-06 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">05</span>   <span class="params">| 周梅   |</span> <span class="number">1991</span>-<span class="number">12</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">| 1992-03-01 00:00:00 |</span> 女   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">07</span>   <span class="params">| 郑竹   |</span> <span class="number">1989</span>-<span class="number">07</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">7</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>10. 查询没学过”张三”老师讲授的任一门课程的学生姓名</strong></p>
<p>一般涉及到”任意”的都会用到not in这样的取反的结构：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname <span class="keyword">from</span> student</span><br><span class="line"><span class="function"><span class="keyword">where</span> sname not <span class="title">in</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">select</span> s.sname</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">from</span> student <span class="keyword">as</span> s, course <span class="keyword">as</span> c, teacher <span class="keyword">as</span> t, sc</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">where</span> s.sid = sc.sid</span></span></span><br><span class="line"><span class="function"><span class="params">        and sc.cid = c.cid</span></span></span><br><span class="line"><span class="function"><span class="params">        and c.tid = t.tid</span></span></span><br><span class="line"><span class="function"><span class="params">        and t.tname = <span class="string">'张三'</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>)</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+--------+</span><br><span class="line"><span class="params">| sname  |</span></span><br><span class="line">+--------+</span><br><span class="line"><span class="params">| 吴兰   |</span></span><br><span class="line"><span class="params">| 王菊   |</span></span><br><span class="line">+--------+</span><br><span class="line"><span class="number">2</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>11. 查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid, s.sname, avg(score)</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> s, sc</span><br><span class="line"><span class="keyword">where</span> s.sid = sc.sid and score&lt;<span class="number">60</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> s.sid</span><br><span class="line"><span class="function">having <span class="title">count</span>(<span class="params">score</span>)&gt;</span>=<span class="number">2</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+------------+</span><br><span class="line"><span class="params">| sid  |</span> sname  <span class="params">| avg(score) |</span></span><br><span class="line">+------+--------+------------+</span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">|   33.33333 |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">|   32.50000 |</span></span><br><span class="line">+------+--------+------------+</span><br><span class="line"><span class="number">2</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>12. 检索” 01 “课程分数小于 60，按分数降序排列的学生信息</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.* ,score</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">as</span> s, sc</span><br><span class="line"><span class="keyword">where</span> cid = <span class="number">01</span></span><br><span class="line">  and score &lt; <span class="number">60</span></span><br><span class="line">  and s.sid=sc.sid</span><br><span class="line">order <span class="keyword">by</span> score desc</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+-------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">| score |</span></span><br><span class="line">+------+--------+---------------------+------+-------+</span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">| 1990-08-06 00:00:00 |</span> 男   <span class="params">|  50.0 |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">| 1992-03-01 00:00:00 |</span> 女   <span class="params">|  31.0 |</span></span><br><span class="line">+------+--------+---------------------+------+-------+</span><br><span class="line"><span class="number">2</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>13. 按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sid,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">01</span> then score <span class="keyword">else</span> <span class="literal">null</span> end) <span class="keyword">as</span> score_01,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">02</span> then score <span class="keyword">else</span> <span class="literal">null</span> end) <span class="keyword">as</span> score_02,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> cid=<span class="number">03</span> then score <span class="keyword">else</span> <span class="literal">null</span> end) <span class="keyword">as</span> score_03,</span><br><span class="line">    avg(score)</span><br><span class="line"><span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> sid</span><br><span class="line"><span class="function">order <span class="keyword">by</span> <span class="title">avg</span>(<span class="params">score</span>) desc</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+------+----------+----------+----------+------------+</span><br><span class="line"><span class="params">| sid  |</span> score_01 <span class="params">| score_02 |</span> score_03 <span class="params">| avg(score) |</span></span><br><span class="line">+------+----------+----------+----------+------------+</span><br><span class="line"><span class="params">| 07   |</span>     NULL <span class="params">|     89.0 |</span>     <span class="number">98.0</span> <span class="params">|   93.50000 |</span></span><br><span class="line"><span class="params">| 01   |</span>     <span class="number">80.0</span> <span class="params">|     90.0 |</span>     <span class="number">99.0</span> <span class="params">|   89.66667 |</span></span><br><span class="line"><span class="params">| 05   |</span>     <span class="number">76.0</span> <span class="params">|     87.0 |</span>     NULL <span class="params">|   81.50000 |</span></span><br><span class="line"><span class="params">| 03   |</span>     <span class="number">80.0</span> <span class="params">|     80.0 |</span>     <span class="number">80.0</span> <span class="params">|   80.00000 |</span></span><br><span class="line"><span class="params">| 02   |</span>     <span class="number">70.0</span> <span class="params">|     60.0 |</span>     <span class="number">80.0</span> <span class="params">|   70.00000 |</span></span><br><span class="line"><span class="params">| 04   |</span>     <span class="number">50.0</span> <span class="params">|     30.0 |</span>     <span class="number">20.0</span> <span class="params">|   33.33333 |</span></span><br><span class="line"><span class="params">| 06   |</span>     <span class="number">31.0</span> <span class="params">|     NULL |</span>     <span class="number">34.0</span> <span class="params">|   32.50000 |</span></span><br><span class="line">+------+----------+----------+----------+------------+</span><br><span class="line"><span class="number">7</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>14. 查询各科成绩最高分、最低分和平均分，以如下形式显示：课程 ID，课程 name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率(及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90）。<br> 要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</strong></p>
<p>这道题熟练掌握case和sum的用法就没什么问题</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select <span class="built_in">c</span>.cid <span class="keyword">as</span> 课程号, <span class="built_in">c</span>.cname <span class="keyword">as</span> 课程名称, <span class="built_in">count</span>(*) <span class="keyword">as</span> 选修人数,</span><br><span class="line">    <span class="built_in">max</span>(score) <span class="keyword">as</span> 最高分, <span class="built_in">min</span>(score) <span class="keyword">as</span> 最低分, avg(score) <span class="keyword">as</span> 平均分,</span><br><span class="line">    sum(<span class="keyword">case</span> when score &gt;= <span class="number">60</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/<span class="built_in">count</span>(*) <span class="keyword">as</span> 及格率,</span><br><span class="line">    sum(<span class="keyword">case</span> when score &gt;= <span class="number">70</span> and score &lt; <span class="number">80</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/<span class="built_in">count</span>(*) <span class="keyword">as</span> 中等率,</span><br><span class="line">    sum(<span class="keyword">case</span> when score &gt;= <span class="number">80</span> and score &lt; <span class="number">90</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/<span class="built_in">count</span>(*) <span class="keyword">as</span> 优良率,</span><br><span class="line">    sum(<span class="keyword">case</span> when score &gt;= <span class="number">90</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/<span class="built_in">count</span>(*) <span class="keyword">as</span> 优秀率</span><br><span class="line">from sc, course <span class="built_in">c</span></span><br><span class="line"><span class="keyword">where</span> <span class="built_in">c</span>.cid = sc.cid</span><br><span class="line">group by <span class="built_in">c</span>.cid</span><br><span class="line">order by <span class="built_in">count</span>(*) desc, <span class="built_in">c</span>.cid asc</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+-----------+--------------+--------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+</span><br><span class="line"><span class="params">| 课程号    |</span> 课程名称      <span class="params">| 选修人数      |</span> 最高分     <span class="params">| 最低分    |</span> 平均分     <span class="params">| 及格率    |</span> 中等率    <span class="params">| 优良率     |</span> 优秀率     <span class="params">|</span></span><br><span class="line"><span class="params">+-----------+--------------+--------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>        <span class="params">| 语文         |</span>            <span class="number">6</span> <span class="params">|      80.0 |</span>      <span class="number">31.0</span> <span class="params">|  64.50000 |</span>    <span class="number">0</span>.<span class="number">6667</span> <span class="params">|    0.3333 |</span>    <span class="number">0</span>.<span class="number">3333</span> <span class="params">|    0.0000 |</span></span><br><span class="line"><span class="params">| 02        |</span> 数学         <span class="params">|            6 |</span>      <span class="number">90.0</span> <span class="params">|      30.0 |</span>  <span class="number">72.66667</span> <span class="params">|    0.8333 |</span>    <span class="number">0</span>.<span class="number">0000</span> <span class="params">|    0.5000 |</span>    <span class="number">0</span>.<span class="number">1667</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>        <span class="params">| 英语         |</span>            <span class="number">6</span> <span class="params">|      99.0 |</span>      <span class="number">20.0</span> <span class="params">|  68.50000 |</span>    <span class="number">0</span>.<span class="number">6667</span> <span class="params">|    0.0000 |</span>    <span class="number">0</span>.<span class="number">3333</span> <span class="params">|    0.3333 |</span></span><br><span class="line">+-----------+--------------+--------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p>原作者的写法本质上和我是相同的，但是用了很多left join看起来有些冗余</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> distinct A.Cid,Cname,最高分,最低分,平均分,及格率,中等率,优良率,优秀率 <span class="keyword">from</span> SC A</span><br><span class="line">left <span class="keyword">join</span> Course <span class="keyword">on</span> A.Cid=Course.Cid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> Cid,MAX(score</span>)最高分,<span class="title">MIN</span>(<span class="params">score</span>)最低分,<span class="title">AVG</span>(<span class="params">score</span>)平均分 <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> Cid)B <span class="keyword">on</span> A.Cid</span>=B.Cid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> Cid,(convert(<span class="keyword">decimal</span>(<span class="number">5</span>,<span class="number">2</span></span>),(<span class="params">sum(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">60</span> then <span class="number">1</span> else <span class="number">0</span> end</span>)*1.00)/<span class="title">COUNT</span>(<span class="params">*</span>))*100)及格率 <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> Cid)C <span class="keyword">on</span> A.Cid</span>=C.Cid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> Cid,(convert(<span class="keyword">decimal</span>(<span class="number">5</span>,<span class="number">2</span></span>),(<span class="params">sum(<span class="keyword">case</span> <span class="keyword">when</span> score &gt;=<span class="number">70</span> and score&lt;<span class="number">80</span> then <span class="number">1</span> else <span class="number">0</span> end</span>)*1.00)/<span class="title">COUNT</span>(<span class="params">*</span>))*100)中等率 <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> Cid)D <span class="keyword">on</span> A.Cid</span>=D.Cid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> Cid,(convert(<span class="keyword">decimal</span>(<span class="number">5</span>,<span class="number">2</span></span>),(<span class="params">sum(<span class="keyword">case</span> <span class="keyword">when</span> score &gt;=<span class="number">80</span> and score&lt;<span class="number">90</span> then <span class="number">1</span> else <span class="number">0</span> end</span>)*1.00)/<span class="title">COUNT</span>(<span class="params">*</span>))*100)优良率 <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> Cid)E <span class="keyword">on</span> A.Cid</span>=E.Cid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> Cid,(convert(<span class="keyword">decimal</span>(<span class="number">5</span>,<span class="number">2</span></span>),(<span class="params">sum(<span class="keyword">case</span> <span class="keyword">when</span> score &gt;=<span class="number">90</span> then <span class="number">1</span> else <span class="number">0</span> end</span>)*1.00)/<span class="title">COUNT</span>(<span class="params">*</span>))*100)优秀率</span></span><br><span class="line"><span class="function"><span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> Cid)F <span class="keyword">on</span> A.Cid</span>=F.Cid</span><br></pre></td></tr></table></figure>

<p><strong>15. 按平均成绩进行排序，显示总排名和各科排名，Score 重复时保留名次空缺</strong></p>
<p>原题目是按各科成绩进行排序，并显示排名， Score 重复时保留名次空缺。但是我没看明白什么意思，各科成绩如何排序？语文分数和数学分数有可比性吗？作者的写法是<code>select *,RANK()over(order by score desc)排名 from SC</code>，把所有的成绩都放到一块儿排序了，这没有意义，不可比。于是我修改了一下题目。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.*, rank_01, rank_02, rank_03, rank_total</span><br><span class="line"><span class="keyword">from</span> student s</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, rank(</span>) <span class="title">over</span>(<span class="params">partition <span class="keyword">by</span> cid order <span class="keyword">by</span> score desc</span>) <span class="keyword">as</span> rank_01 <span class="keyword">from</span> sc <span class="keyword">where</span> cid</span>=<span class="number">01</span>) A <span class="keyword">on</span> s.sid=A.sid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, rank(</span>) <span class="title">over</span>(<span class="params">partition <span class="keyword">by</span> cid order <span class="keyword">by</span> score desc</span>) <span class="keyword">as</span> rank_02 <span class="keyword">from</span> sc <span class="keyword">where</span> cid</span>=<span class="number">02</span>) B <span class="keyword">on</span> s.sid=B.sid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, rank(</span>) <span class="title">over</span>(<span class="params">partition <span class="keyword">by</span> cid order <span class="keyword">by</span> score desc</span>) <span class="keyword">as</span> rank_03 <span class="keyword">from</span> sc <span class="keyword">where</span> cid</span>=<span class="number">03</span>) C <span class="keyword">on</span> s.sid=C.sid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, rank(</span>) <span class="title">over</span>(<span class="params">order <span class="keyword">by</span> avg(score</span>) desc) <span class="keyword">as</span> rank_total <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> sid) D <span class="keyword">on</span> s.sid</span>=D.sid</span><br><span class="line">order <span class="keyword">by</span> rank_total asc</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+---------+---------+---------+------------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">| rank_01 |</span> rank_02 <span class="params">| rank_03 |</span> rank_total <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+---------+---------+---------+------------+</span></span><br><span class="line"><span class="params">|</span> 08   <span class="params">| 王菊   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span>    NULL <span class="params">|    NULL |</span>    NULL <span class="params">|       NULL |</span></span><br><span class="line"><span class="params">| 07   |</span> 郑竹   <span class="params">| 1989-07-01 00:00:00 |</span> 女   <span class="params">|    NULL |</span>       <span class="number">2</span> <span class="params">|       2 |</span>          <span class="number">1</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 赵雷   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span>       <span class="number">1</span> <span class="params">|       1 |</span>       <span class="number">1</span> <span class="params">|          2 |</span></span><br><span class="line"><span class="params">| 05   |</span> 周梅   <span class="params">| 1991-12-01 00:00:00 |</span> 女   <span class="params">|       3 |</span>       <span class="number">3</span> <span class="params">|    NULL |</span>          <span class="number">3</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span> <span class="number">1990</span>-<span class="number">05</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span>       <span class="number">1</span> <span class="params">|       4 |</span>       <span class="number">3</span> <span class="params">|          4 |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">| 1990-12-21 00:00:00 |</span> 男   <span class="params">|       4 |</span>       <span class="number">5</span> <span class="params">|       3 |</span>          <span class="number">5</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">04</span>   <span class="params">| 李云   |</span> <span class="number">1990</span>-08-<span class="number">06</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span>       <span class="number">5</span> <span class="params">|       6 |</span>       <span class="number">6</span> <span class="params">|          6 |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">| 1992-03-01 00:00:00 |</span> 女   <span class="params">|       6 |</span>    NULL <span class="params">|       5 |</span>          <span class="number">7</span> <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+---------+---------+---------+------------+</span></span><br><span class="line"><span class="params">8 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p><strong>15.1 按平均成绩进行排序，显示总排名和各科排名，Score 重复时合并名次</strong></p>
<p>同样修改了一下题目。15题和15.1题的指向很明确了，就是rank()和dense_rank()的区别，也就是两个并列第一名之后的那个人是第三名(rank)还是第二名(dense_rank)的区别。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.*, rank_01, rank_02, rank_03, rank_total</span><br><span class="line"><span class="keyword">from</span> student s</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, dense_rank(</span>) <span class="title">over</span>(<span class="params">partition <span class="keyword">by</span> cid order <span class="keyword">by</span> score desc</span>) <span class="keyword">as</span> rank_01 <span class="keyword">from</span> sc <span class="keyword">where</span> cid</span>=<span class="number">01</span>) A <span class="keyword">on</span> s.sid=A.sid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, dense_rank(</span>) <span class="title">over</span>(<span class="params">partition <span class="keyword">by</span> cid order <span class="keyword">by</span> score desc</span>) <span class="keyword">as</span> rank_02 <span class="keyword">from</span> sc <span class="keyword">where</span> cid</span>=<span class="number">02</span>) B <span class="keyword">on</span> s.sid=B.sid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, dense_rank(</span>) <span class="title">over</span>(<span class="params">partition <span class="keyword">by</span> cid order <span class="keyword">by</span> score desc</span>) <span class="keyword">as</span> rank_03 <span class="keyword">from</span> sc <span class="keyword">where</span> cid</span>=<span class="number">03</span>) C <span class="keyword">on</span> s.sid=C.sid</span><br><span class="line"><span class="function">left <span class="title">join</span> (<span class="params"><span class="keyword">select</span> sid, dense_rank(</span>) <span class="title">over</span>(<span class="params">order <span class="keyword">by</span> avg(score</span>) desc) <span class="keyword">as</span> rank_total <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> sid) D <span class="keyword">on</span> s.sid</span>=D.sid</span><br><span class="line">order <span class="keyword">by</span> rank_total asc</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+---------+---------+---------+------------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">| rank_01 |</span> rank_02 <span class="params">| rank_03 |</span> rank_total <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+---------+---------+---------+------------+</span></span><br><span class="line"><span class="params">|</span> 08   <span class="params">| 王菊   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span>    NULL <span class="params">|    NULL |</span>    NULL <span class="params">|       NULL |</span></span><br><span class="line"><span class="params">| 07   |</span> 郑竹   <span class="params">| 1989-07-01 00:00:00 |</span> 女   <span class="params">|    NULL |</span>       <span class="number">2</span> <span class="params">|       2 |</span>          <span class="number">1</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 赵雷   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span>       <span class="number">1</span> <span class="params">|       1 |</span>       <span class="number">1</span> <span class="params">|          2 |</span></span><br><span class="line"><span class="params">| 05   |</span> 周梅   <span class="params">| 1991-12-01 00:00:00 |</span> 女   <span class="params">|       2 |</span>       <span class="number">3</span> <span class="params">|    NULL |</span>          <span class="number">3</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span> <span class="number">1990</span>-<span class="number">05</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span>       <span class="number">1</span> <span class="params">|       4 |</span>       <span class="number">3</span> <span class="params">|          4 |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">| 1990-12-21 00:00:00 |</span> 男   <span class="params">|       3 |</span>       <span class="number">5</span> <span class="params">|       3 |</span>          <span class="number">5</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">04</span>   <span class="params">| 李云   |</span> <span class="number">1990</span>-08-<span class="number">06</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span>       <span class="number">4</span> <span class="params">|       6 |</span>       <span class="number">5</span> <span class="params">|          6 |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">| 1992-03-01 00:00:00 |</span> 女   <span class="params">|       5 |</span>    NULL <span class="params">|       4 |</span>          <span class="number">7</span> <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+---------+---------+---------+------------+</span></span><br><span class="line"><span class="params">8 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p><strong>17. 统计各科成绩各分数段人数：课程编号，课程名称，[100-85]，[85-70]，[70-60]，[60-0] 及所占百分比</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c.cid <span class="keyword">as</span> 课程编号, c.cname <span class="keyword">as</span> 课程名称, A.*</span><br><span class="line"><span class="keyword">from</span> course <span class="keyword">as</span> c,</span><br><span class="line">(<span class="keyword">select</span> cid,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> score &gt;= <span class="number">85</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/count(*) <span class="keyword">as</span> <span class="number">100</span>_85,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> score &gt;= <span class="number">70</span> and score &lt; <span class="number">85</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/count(*) <span class="keyword">as</span> <span class="number">85</span>_70,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> score &gt;= <span class="number">60</span> and score &lt; <span class="number">70</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/count(*) <span class="keyword">as</span> <span class="number">70</span>_60,</span><br><span class="line">    sum(<span class="keyword">case</span> <span class="keyword">when</span> score &lt; <span class="number">60</span> then <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> end)/count(*) <span class="keyword">as</span> <span class="number">60</span>_0</span><br><span class="line"><span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> cid) <span class="keyword">as</span> A</span><br><span class="line"><span class="keyword">where</span> c.cid = A.cid</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+--------------+--------------+------+--------+--------+--------+--------+</span><br><span class="line"><span class="params">| 课程编号     |</span> 课程名称      <span class="params">| cid  |</span> <span class="number">100_85</span> <span class="params">| 85_70  |</span> <span class="number">70_60</span>  <span class="params">| 60_0   |</span></span><br><span class="line">+--------------+--------------+------+--------+--------+--------+--------+</span><br><span class="line"><span class="params">| 01           |</span> 语文         <span class="params">| 01   |</span> <span class="number">0</span>.<span class="number">0000</span> <span class="params">| 0.6667 |</span> <span class="number">0</span>.<span class="number">0000</span> <span class="params">| 0.3333 |</span></span><br><span class="line"><span class="params">| 02           |</span> 数学         <span class="params">| 02   |</span> <span class="number">0</span>.<span class="number">5000</span> <span class="params">| 0.1667 |</span> <span class="number">0</span>.<span class="number">1667</span> <span class="params">| 0.1667 |</span></span><br><span class="line"><span class="params">| 03           |</span> 英语         <span class="params">| 03   |</span> <span class="number">0</span>.<span class="number">3333</span> <span class="params">| 0.3333 |</span> <span class="number">0</span>.<span class="number">0000</span> <span class="params">| 0.3333 |</span></span><br><span class="line">+--------------+--------------+------+--------+--------+--------+--------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>18. 查询各科成绩前三名的记录</strong></p>
<p>这是我比较喜欢的一道题目，非常经典。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> *, rank() over(partition <span class="keyword">by</span> cid order <span class="keyword">by</span> score desc) <span class="keyword">as</span> graderank <span class="keyword">from</span> sc) A </span><br><span class="line"><span class="keyword">where</span> A.graderank &lt;= <span class="number">3</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">| Sid  |</span> Cid  <span class="params">| score |</span> graderank <span class="params">|</span></span><br><span class="line"><span class="params">+------+------+-------+-----------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 01   |</span>  <span class="number">80.0</span> <span class="params">|         1 |</span></span><br><span class="line"><span class="params">| 03   |</span> <span class="number">01</span>   <span class="params">|  80.0 |</span>         <span class="number">1</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">05</span>   <span class="params">| 01   |</span>  <span class="number">76.0</span> <span class="params">|         3 |</span></span><br><span class="line"><span class="params">| 01   |</span> <span class="number">02</span>   <span class="params">|  90.0 |</span>         <span class="number">1</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">07</span>   <span class="params">| 02   |</span>  <span class="number">89.0</span> <span class="params">|         2 |</span></span><br><span class="line"><span class="params">| 05   |</span> <span class="number">02</span>   <span class="params">|  87.0 |</span>         <span class="number">3</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 03   |</span>  <span class="number">99.0</span> <span class="params">|         1 |</span></span><br><span class="line"><span class="params">| 07   |</span> <span class="number">03</span>   <span class="params">|  98.0 |</span>         <span class="number">2</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">02</span>   <span class="params">| 03   |</span>  <span class="number">80.0</span> <span class="params">|         3 |</span></span><br><span class="line"><span class="params">| 03   |</span> <span class="number">03</span>   <span class="params">|  80.0 |</span>         <span class="number">3</span> <span class="params">|</span></span><br><span class="line"><span class="params">+------+------+-------+-----------+</span></span><br><span class="line"><span class="params">10 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p><strong>20. 查询出只选修两门课程的学生学号和姓名</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid, s.sname, count(cid)</span><br><span class="line"><span class="keyword">from</span> student s, sc</span><br><span class="line"><span class="keyword">where</span> s.sid = sc.sid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> s.sid</span><br><span class="line"><span class="function">having <span class="title">count</span>(<span class="params">cid</span>)</span>=<span class="number">2</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+------------+</span><br><span class="line"><span class="params">| sid  |</span> sname  <span class="params">| count(cid) |</span></span><br><span class="line">+------+--------+------------+</span><br><span class="line"><span class="params">| 05   |</span> 周梅   <span class="params">|          2 |</span></span><br><span class="line"><span class="params">| 06   |</span> 吴兰   <span class="params">|          2 |</span></span><br><span class="line"><span class="params">| 07   |</span> 郑竹   <span class="params">|          2 |</span></span><br><span class="line">+------+--------+------------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>22. 查询名字中含有「风」字的学生信息</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> sname like <span class="string">'%风%'</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span> <span class="number">1990</span>-<span class="number">05</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>24. 查询 1990 年出生的学生名单</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="keyword">where</span> <span class="title">year</span>(<span class="params">sage</span>)</span> = <span class="number">1990</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 赵雷   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 02   |</span> 钱电   <span class="params">| 1990-12-21 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> <span class="number">03</span>   <span class="params">| 孙风   |</span> <span class="number">1990</span>-<span class="number">05</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line"><span class="params">| 04   |</span> 李云   <span class="params">| 1990-08-06 00:00:00 |</span> 男   <span class="params">|</span></span><br><span class="line"><span class="params">|</span> 08   <span class="params">| 王菊   |</span> <span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">5</span> rows <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>33. 成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select s.*, <span class="built_in">max</span>(score)</span><br><span class="line">from student s, teacher t, course <span class="built_in">c</span>, sc</span><br><span class="line"><span class="keyword">where</span> s.sid = sc.sid</span><br><span class="line">    and sc.cid = <span class="built_in">c</span>.cid</span><br><span class="line">    and <span class="built_in">c</span>.tid = t.tid</span><br><span class="line">    and t.tname = '张三'</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+------------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">| max(score) |</span></span><br><span class="line">+------+--------+---------------------+------+------------+</span><br><span class="line"><span class="params">| 01   |</span> 赵雷   <span class="params">| 1990-01-01 00:00:00 |</span> 男   <span class="params">|       90.0 |</span></span><br><span class="line">+------+--------+---------------------+------+------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>34. 成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> *, DENSE_RANK() over (order <span class="keyword">by</span> score desc) A</span><br><span class="line">    <span class="keyword">from</span> SC</span><br><span class="line">    <span class="keyword">where</span> Cid = (<span class="keyword">select</span> Cid <span class="keyword">from</span> Course <span class="keyword">where</span> Tid=(<span class="keyword">select</span> Tid <span class="keyword">from</span> Teacher <span class="keyword">where</span> Tname=<span class="string">'张三'</span>))</span><br><span class="line">) B</span><br><span class="line"><span class="keyword">where</span> B.A=<span class="number">1</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+---+</span><br><span class="line"><span class="params">| Sid  |</span> Cid  <span class="params">| score |</span> A <span class="params">|</span></span><br><span class="line"><span class="params">+------+------+-------+---+</span></span><br><span class="line"><span class="params">|</span> <span class="number">01</span>   <span class="params">| 02   |</span>  <span class="number">90.0</span> <span class="params">| 1 |</span></span><br><span class="line">+------+------+-------+---+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>40. 查询各学生的年龄，只按年份来算</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname, year(now())-year(sage) <span class="keyword">as</span> age <span class="keyword">from</span> student</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+--------+------+</span><br><span class="line"><span class="params">| sname  |</span> age  <span class="params">|</span></span><br><span class="line"><span class="params">+--------+------+</span></span><br><span class="line"><span class="params">|</span> 赵雷   <span class="params">|   28 |</span></span><br><span class="line"><span class="params">| 钱电   |</span>   <span class="number">28</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> 孙风   <span class="params">|   28 |</span></span><br><span class="line"><span class="params">| 李云   |</span>   <span class="number">28</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> 周梅   <span class="params">|   27 |</span></span><br><span class="line"><span class="params">| 吴兰   |</span>   <span class="number">26</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> 郑竹   <span class="params">|   29 |</span></span><br><span class="line"><span class="params">| 王菊   |</span>   <span class="number">28</span> <span class="params">|</span></span><br><span class="line"><span class="params">+--------+------+</span></span><br><span class="line"><span class="params">8 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p><strong>41. 按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname, timestampdiff(year, sage, now()) <span class="keyword">as</span> age <span class="keyword">from</span> student</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+--------+------+</span><br><span class="line"><span class="params">| sname  |</span> age  <span class="params">|</span></span><br><span class="line"><span class="params">+--------+------+</span></span><br><span class="line"><span class="params">|</span> 赵雷   <span class="params">|   28 |</span></span><br><span class="line"><span class="params">| 钱电   |</span>   <span class="number">27</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> 孙风   <span class="params">|   28 |</span></span><br><span class="line"><span class="params">| 李云   |</span>   <span class="number">27</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> 周梅   <span class="params">|   26 |</span></span><br><span class="line"><span class="params">| 吴兰   |</span>   <span class="number">26</span> <span class="params">|</span></span><br><span class="line"><span class="params">|</span> 郑竹   <span class="params">|   29 |</span></span><br><span class="line"><span class="params">| 王菊   |</span>   <span class="number">28</span> <span class="params">|</span></span><br><span class="line"><span class="params">+--------+------+</span></span><br><span class="line"><span class="params">8 rows <span class="keyword">in</span> set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p><strong>42. 查询本周过生日的学生</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="keyword">where</span> <span class="title">week</span>(<span class="params">now(</span>))</span> = week(sage)</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Empty <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>43. 查询下周过生日的学生</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="title">where</span> (<span class="params">week(now(</span>))+1)</span> = week(sage)</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">04</span>   <span class="params">| 李云   |</span> <span class="number">1990</span>-08-<span class="number">06</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>44. 查询本月过生日的学生</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="keyword">where</span> <span class="title">month</span>(<span class="params">now(</span>))</span> = month(sage)</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">07</span>   <span class="params">| 郑竹   |</span> <span class="number">1989</span>-<span class="number">07</span>-<span class="number">01</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 女   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>45. 查询下月过生日的学生</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="function"><span class="keyword">from</span> student <span class="title">where</span> (<span class="params">month(now(</span>))+1)</span> = month(sage)</span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="params">| Sid  |</span> Sname  <span class="params">| Sage                |</span> Ssex <span class="params">|</span></span><br><span class="line"><span class="params">+------+--------+---------------------+------+</span></span><br><span class="line"><span class="params">|</span> <span class="number">04</span>   <span class="params">| 李云   |</span> <span class="number">1990</span>-08-<span class="number">06</span> <span class="number">00</span><span class="symbol">:</span><span class="number">00</span><span class="symbol">:</span><span class="number">00</span> <span class="params">| 男   |</span></span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0</span>.<span class="number">00</span> sec)</span><br></pre></td></tr></table></figure>



      
    </div>
    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
      
    </div>

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>觉得文章对您有帮助请我喝杯咖啡吧^_^</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/uploads/wechatpay.jpg" alt="Insomnia 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/uploads/alipay.jpg" alt="Insomnia 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Insomnia
  </li>
 <li class="post-copyright-link">
  <strong>本文链接：</strong>
  <a href="http://insomnia.ltd/2020/04/16/SQL语句练习/" target="_blank" rel="noopener" title="SQL语句练习">http://insomnia.ltd/2020/04/16/SQL语句练习/</a>
</li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/SQL%E8%AF%AD%E5%8F%A5%E7%BB%83%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> SQL语句练习</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/04/10/HashMap%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/" rel="next" title="HashMap执行流程">
                <i class="fa fa-chevron-left"></i> HashMap执行流程
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80OTEwMi8yNTU5Nw"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/Insomnia.png"
                alt="Insomnia" />
            
              <p class="site-author-name" itemprop="name">Insomnia</p>
              <p class="site-description motion-element" itemprop="description">不渴望能够一跃千里<br>只希望每天能够前进一步</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zclai163" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="zclai163@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i></a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
    <div id="music163player">
      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=450 src="//music.163.com/outchain/player?type=0&id=469287262&auto=1&height=430"></iframe>
      </ifname>
    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fas fa-carrot" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Insomnia</span>

<!--
  

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">21.4k</span>
  
  -->
</div>

<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>


<div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style='display:none'>
    本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style='display:none'>
    有<span id="busuanzi_value_site_uv"></span>人看过我的博客啦
</span>
</div>


-->

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共21.4k字</span>
</div>

<!--添加网站的运行时间-->
<span id="sitetime"> <br></span>
<script language="javascript">
	function siteTime(){
		window.setTimeout("siteTime()", 1000);
		var seconds = 1000
		var minutes = seconds * 60
		var hours = minutes * 60
		var days = hours * 24
		var years = days * 365

		var today = new Date()
		var todayYear = today.getFullYear()
		var todayMonth = today.getMonth()
		var todayDate = today.getDate()
		var todayHour = today.getHours()
		var todayMinute = today.getMinutes()
		var todaySecond = today.getSeconds()
		var t1 = Date.UTC(2018,3,18,11,00,00)
		var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond)
		var diff = t2-t1

		var diffYears = Math.floor(diff/years)
		var diffDays = Math.floor((diff/days)-diffYears*365)
		var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours)
		var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes)
		var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds)
		document.getElementById("sitetime").innerHTML=" 本站已运行"+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒<br>"
	}
	siteTime()
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname, 
            owner: 'zclai163',
            repo: 'Insomnia-Java',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: '189093d4a5b71b9d92a02467f82093ef32750474',
            
                client_id: 'Iv1.e9169c445231e016'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("t2DAk39HbmXISjDTVR6jHp6x-gzGzoHsz", "oFkDT0S2SzUxCCvd2w468y2S");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  

  

  

</body>
</html>
